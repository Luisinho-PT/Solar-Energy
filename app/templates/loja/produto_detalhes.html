{% extends "base.html" %}
{% load static %}
{% block title %}{{ produto.nome }} ‚Äî Loja{% endblock %}

{% block content %}
<div class="loja-container">

  <a href="{% url 'home' %}" class="category-item" style="margin-bottom:12px; display:inline-block;">‚Üê Voltar √† loja</a>

  <div class="product-detail">

    <!-- COLUNA IMAGENS -->
    <div>
      <div class="detail-media">
        <div class="detail-main-img">
          {% if produto.imagem %}
            <img id="mainImg" src="{{ produto.imagem.url }}" alt="{{ produto.nome }}">
          {% else %}
            <img id="mainImg" src="{% static 'images/placeholder-product.png' %}" alt="sem imagem">
          {% endif %}
        </div>

        <div class="detail-thumbs">
          {% if produto.imagem %}
            <div class="detail-thumb" onclick="document.getElementById('mainImg').src='{{ produto.imagem.url }}'">
              <img src="{{ produto.imagem.url }}" alt="">
            </div>
          {% endif %}
          <!-- Caso queira m√∫ltiplas imagens, gere thumbs aqui -->
        </div>
      </div>

      <!-- RECOMENDADOS -->
      {% if relacionados %}
        <div style="margin-top:16px">
          <h3>Produtos relacionados</h3>
          <div class="related-grid">
            {% for r in relacionados %}
              <div class="related-card">
                <a href="{% url 'produto_detalhes' r.id %}" style="text-decoration:none; color:inherit;">
                  {% if r.imagem %}
                    <img src="{{ r.imagem.url }}" style="height:100px; object-fit:contain; margin-bottom:8px;">
                  {% endif %}
                  <div style="font-weight:700; font-size:14px;">{{ r.nome }}</div>
                  <div style="color:var(--muted); margin-top:6px;">R$ {{ r.preco|floatformat:2 }}</div>
                </a>
              </div>
            {% endfor %}
          </div>
        </div>
      {% endif %}
    </div>

    <!-- COLUNA INFORMA√á√ïES -->
    <div>
      <div class="detail-info card">
        <h1>{{ produto.nome }}</h1>
        <div class="price">R$ {{ produto.preco|floatformat:2 }}</div>
        <div class="sku">C√≥digo: {{ produto.id }}</div>

        <div class="desc">
          {{ produto.descricao|linebreaksbr }}
        </div>

        <div style="margin-top:12px;">
          {% if produto.em_estoque %}
            <span class="stock-badge in-stock">‚úÖ Em estoque ({{ produto.estoque }})</span>
          {% else %}
            <span class="stock-badge out-stock">‚ùå Esgotado</span>
          {% endif %}
        </div>

        <div class="buy-row">
          <form method="post" action="{% url 'adicionar_carrinho' %}">
            {% csrf_token %}
            <input type="hidden" name="produto_id" value="{{ produto.id }}">
            <input type="number" name="quantidade" value="1" min="1" max="{{ produto.estoque }}" class="qty-input">
            {% if produto.em_estoque %}
              <button class="btn-card btn-buy" type="submit">üõí Adicionar ao carrinho</button>
              <button formaction="{% url 'comprar_agora' produto.id %}" class="btn-card btn-details">Comprar agora</button>
            {% else %}
              <button class="btn-card btn-buy" disabled>Indispon√≠vel</button>
            {% endif %}
          </form>
        </div>

        <div style="margin-top:18px;">
          <strong>Garantia:</strong> 1 ano (padr√£o). Consulte o produto para info detalhada.
        </div>

        <!-- AVALIA√á√ïES placeholder -->
        <div style="margin-top:14px;">
          <strong>Avalia√ß√µes:</strong>
          <p style="color:var(--muted);">Ainda n√£o h√° avalia√ß√µes.</p>
        </div>
      </div>
    </div>

  </div>
</div>

{% endblock %}
